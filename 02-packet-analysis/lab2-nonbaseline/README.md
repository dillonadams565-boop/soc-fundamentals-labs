# Lab 2 — Non-Baseline Network Traffic Analysis

## Objective
Identify network traffic patterns that deviate from normal baseline behaviour across DNS, TCP, and TLS using Wireshark.

## Scope
This lab focuses on:
- DNS traffic anomalies
- TCP connection behaviour that differs from normal use
- TLS session characteristics that may appear unusual compared to typical browsing

## Environment
- Host OS: Windows
- Tool used: Wireshark
- Network: Home network

## Method
Traffic was intentionally generated to create non-baseline patterns. All traffic was captured using Wireshark and analysed to determine how it differs from normal user activity and whether it could be considered suspicious from a SOC perspective.

---

## DNS Analysis — Non-Baseline Behaviour

### What was done
Repeated DNS lookups were generated to unique, non-existent subdomains using `nslookup` to intentionally produce failed DNS resolution attempts.

### Wireshark Filter
dns

### What was observed
- A high number of DNS queries in a short time period
- Sequential, unique subdomain names (for example `lab2test1.invalid`, `lab2test2.invalid`)
- All queries resulted in NXDOMAIN (“No such name”) responses
- Traffic pattern differed from normal browsing, which usually involves repeated queries to known domains

### SOC Interpretation
A burst of NXDOMAIN DNS activity like this could indicate automated or scripted behaviour, misconfigured applications, or potential malware beaconing depending on context. In an enterprise environment, this activity would warrant further investigation.

### Evidence
- screenshots/dns_nxdomain_burst.png
- screenshots/dns_nxdomain_response.png
- pcap/dns_nxdomain_nonbaseline.pcapng

---

## TCP Analysis — Non-Baseline Behaviour

### What was done
Repeated TCP connection attempts were generated to destinations that were not accepting connections in order to produce failed TCP handshakes.

### Wireshark Filter
tcp.flags.syn == 1 && tcp.flags.ack == 0

### What was observed
- Repeated TCP SYN packets from the same source
- Connection attempts occurred close together in time
- Multiple SYN retransmissions were observed
- No completed TCP handshakes were seen for the repeated attempts

### SOC Interpretation
Repeated failed TCP connection attempts may indicate port scanning, misconfigured services, or automated behaviour. In an enterprise environment, this pattern would typically be investigated further.

### Evidence
- screenshots/tcp_syn_burst.png
- screenshots/tcp_failed_connection_detail.png
- pcap/tcp_failed_connections_nonbaseline.pcapng

---

## TLS Analysis — Non-Baseline Behaviour

### What was done
TLS traffic was generated by initiating HTTPS connections directly to an IP address rather than through normal domain-based browsing.

### Wireshark Filter
tls

### What was observed
- TLSv1.3 traffic over port 443
- Visibility of TLS Client Hello messages
- Server Name Indication (SNI) present in the Client Hello
- Encrypted application data following the handshake
- Traffic pattern differed slightly from typical browsing due to direct IP usage

### SOC Interpretation
Although the TLS traffic was encrypted and not malicious, analysing handshake metadata such as SNI, protocol versions, and cipher suites is useful for identifying unusual or non-standard TLS behaviour. In a SOC environment, TLS traffic that deviates from normal patterns may warrant further investigation.

### Evidence
- screenshots/tls_nonbaseline_traffic_overview.png
- screenshots/tls_client_hello_details.png
- pcap/tls_nonbaseline_direct_ip.pcapng

---

## Summary
This lab demonstrated how non-baseline network behaviour can be identified across DNS, TCP, and TLS traffic using Wireshark. By intentionally generating abnormal patterns and analysing them from a SOC perspective, the lab reinforced how deviations from normal traffic can be detected and investigated.
